--EXTENTION TO ENABLE GEOMETRY DATA TYPE
CREATE EXTENSION postgis;

--CREATE TABLE
create table LOCATIONS (name varchar, location geometry);

--INSERT INTO TABLE
INSERT INTO LOCATIONS VALUES 
	('Gym',  'POINT(-73.87990890077678 40.74809852525679)'),
	('Supermarket', 'POINT(-73.88033954822836 40.748098678231024)'),
	('Beauty Store', 'POINT(-73.88159398120595 40.74794322591613)'),
	('Bubble Tea', 'POINT(-73.88382715626038 40.74735229309565)'),
	('Halal Food', 'POINT(-73.88462380512979 40.74982033358063)'),
	('Library', 'POINT(-73.8853694631952 40.750037949727314)'),
	('Post Office', 'POINT(-73.88757924934231 40.74932431047302)'),
	('School', 'POINT(-73.88857319026616 40.74921876661568)'),
	('Restaurant', 'POINT(-73.89109746735981 40.74912573207059)'),
	('Deli', 'POINT(-73.88954071334925 40.74709843847988)'),
	('Taco Truck', 'POINT(-73.88858577073538 40.74725519934789)'),
	('Home', 'POINT(-73.8797978514181 40.74726820817161)'),
	('Starbucks', 'POINT(-73.89027496806708 40.74703867551027)');

--VALIDATING DATA EXISTS
Select name, ST_AsText(location) from LOCATIONS;

--CONVEX HULL CALCULATION
SELECT ST_AsText(ST_ConvexHull(ST_Collect(location))) FROM LOCATIONS;

--COMPUTE FOUR NEAREST NEIGHBORS
SELECT name, ST_AsText(location), ST_Distance(location,'POINT(-73.8797978514181 40.74726820817161)') as distance  
FROM LOCATIONS 
WHERE name <> 'Home'
ORDER BY ST_Distance(location, 'POINT(-73.8797978514181 40.74726820817161)')
LIMIT 4;